
## Box deficit detection models

## DataSet

I'm sorry that the dataset is not allowed to publish.  

## How to train?

### prerequieste
- anadonda3

### install dependencies
In the project root, 

```
conda env create -f=environment.yml
```

### execute train script
In the project root, 

```
export PYTHONPATH=.
python scripts/train.py $MODEL_NAME
```

chose $MODEL_NAME from 
- "resnet50_pretrained"
- "resnet50_pretrained_cosine"
- "resnet50_pretrained_cosine_pruned"

"resnet50_pretrained_cosine_pruned" model have to be trained after training "resnet50_pretrained_cosine".

These train results are saved under [output dir](output)"

##  How to Infer with trained model?

Use  *Inferrer Class* in [inference.py](inference.py).

Please see [inference_sample.py](inference_sample.py) to see how to use it.  


# modeling
- transfer learning
- sparse modeling
- small batch size
- large drop out
- pruning
- cosine annealing
- cosine loss

# base model
- resnet

# scaling
- subtracting the mean channel value 
  computed over the entire training set and dividing by the standard deviation.

# augmentation

- randomly cropped from
    (NGに傷やへこみなど一部の変化だけがある場合、cropにより判断に必要な情報が欠落する可能性があるため行わない)
- random horizontal flipping
- random shifting/cropping